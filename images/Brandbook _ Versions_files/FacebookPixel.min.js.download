var FacebookPixel_RS=function(t){"use strict";function e(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function r(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(Object(o),!0).forEach((function(n){e(t,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var o,i,a,s,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function l(t){return t&&Object.prototype.hasOwnProperty.call(t,"default")&&1===Object.keys(t).length?t.default:t}function f(){if(i)return o;i=1;var t=Object.prototype.hasOwnProperty,e=String.prototype.charAt,n=Object.prototype.toString,r=function(t,n){return e.call(t,n)},a=function(e,n){return t.call(e,n)},s=function(t,e){e=e||a;for(var n=[],r=0,o=t.length;r<o;r+=1)e(t,r)&&n.push(String(r));return n};return o=function(t){return null==t?[]:(e=t,"[object String]"===n.call(e)?s(t,r):function(t){return null!=t&&"function"!=typeof t&&"number"==typeof t.length}(t)?s(t,a):function(t,e){e=e||a;var n=[];for(var r in t)e(t,r)&&n.push(String(r));return n}(t));var e}}var d=function(){if(s)return a;s=1;var t=f(),e=Object.prototype.toString,n="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===e.call(t)},r=function(t){return null!=t&&(n(t)||"function"!==t&&function(t){var n=typeof t;return"number"===n||"object"===n&&"[object Number]"===e.call(t)}(t.length))},o=function(t,e){for(var n=0;n<e.length&&!1!==t(e[n],n,e);n+=1);},i=function(e,n){for(var r=t(n),o=0;o<r.length&&!1!==e(n[r[o]],r[o],n);o+=1);};return a=function(t,e){return(r(e)?o:i).call(this,t,e)}}();const p=u(d);var y={exports:{}};var g={exports:{}};const h=l(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var b;g.exports;function v(){return b||(b=1,g.exports=(t=t||function(t,e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==c&&c.crypto&&(n=c.crypto),!n)try{n=h}catch(t){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},a=i.lib={},s=a.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=s.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||f).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,o=t.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;e[r+i>>>2]|=a<<24-(r+i)%4*8}else for(var s=0;s<o;s+=4)e[r+s>>>2]=n[s>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(r());return new u.init(e,t)}}),l=i.enc={},f=l.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],o=0;o<n;o++){var i=e[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new u.init(n,e/2)}},d=l.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],o=0;o<n;o++){var i=e[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new u.init(n,e)}},p=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(d.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return d.parse(unescape(encodeURIComponent(t)))}},y=a.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n,r=this._data,o=r.words,i=r.sigBytes,a=this.blockSize,s=i/(4*a),c=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*a,l=t.min(4*c,i);if(c){for(var f=0;f<c;f+=a)this._doProcessBlock(o,f);n=o.splice(0,c),r.sigBytes-=l}return new u.init(n,l)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});a.Hasher=y.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new g.HMAC.init(t,n).finalize(e)}}});var g=i.algo={};return i}(Math),t)),g.exports;var t}var m,w;const j=u((m||(m=1,y.exports=(w=v(),function(t){var e=w,n=e.lib,r=n.WordArray,o=n.Hasher,i=e.algo,a=[],s=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var r=2,o=0;o<64;)e(r)&&(o<8&&(a[o]=n(t.pow(r,.5))),s[o]=n(t.pow(r,1/3)),o++),r++}();var c=[],u=i.SHA256=o.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],u=n[4],l=n[5],f=n[6],d=n[7],p=0;p<64;p++){if(p<16)c[p]=0|t[e+p];else{var y=c[p-15],g=(y<<25|y>>>7)^(y<<14|y>>>18)^y>>>3,h=c[p-2],b=(h<<15|h>>>17)^(h<<13|h>>>19)^h>>>10;c[p]=g+c[p-7]+b+c[p-16]}var v=r&o^r&i^o&i,m=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),w=d+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&l^~u&f)+s[p]+c[p];d=f,f=l,l=u,u=a+w|0,a=i,i=o,o=r,r=w+(m+v)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+l|0,n[6]=n[6]+f|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=t.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=o._createHelper(u),e.HmacSHA256=o._createHmacHelper(u)}(Math),w.SHA256)),y.exports));let S=4;const O={setLogLevel(t){switch(t.toUpperCase()){case"INFO":S=1;break;case"DEBUG":S=2;break;case"WARN":S=3;break;default:S=4}},info(...t){S<=1&&console.info(...t)},debug(...t){S<=2&&console.log(...t)},warn(...t){S<=3&&console.warn(...t)},error(...t){S<=4&&console.error(...t)}},A="RS_JS_SDK",x=["Request failed with status:"],I=t=>{var e;const n=null===(e=window.RudderStackGlobals)||void 0===e?void 0:e.errorReporting;n&&t instanceof Error&&n.notify(t)},k=t=>{const e=[];return function(t,n){if("object"!=typeof n||null===n)return n;for(;e.length>0&&e[e.length-1]!==this;)e.pop();return e.includes(n)?(O.debug(`Circular Reference detected for key: ${t}`),"[Circular Reference]"):(e.push(n),n)}},_=(t,e)=>{try{return JSON.stringify(t,k())}catch(t){return O.warn("Failed to convert the value to a JSON string."),null}},P=(t,e,n)=>{let r;try{r=((t,e,n)=>{let r;try{r="string"==typeof t?t:t instanceof Error||t.message?t.message:_(t)}catch(t){r=""}if("object"==typeof(o=t)&&null!==o&&"target"in o){if(t.target&&"script"!==t.target.localName)return"";if(t.target.dataset&&(t.target.dataset.loader!==A||"true"!==t.target.dataset.isnonnativesdk))return"";if(r=`error in script loading:: src::  ${t.target.src} id:: ${t.target.id}`,"ad-block"===t.target.id)return n.page("RudderJS-Initiated","ad-block page request",{path:"/ad-blocked",title:r},n.sendAdblockPageOptions),""}var o;return`[handleError]:: "${r}"`})(t,0,n)}catch(e){O.error("[handleError] Exception:: ",e),O.error("[handleError] Original error:: ",_(t)),I(e)}r&&(O.error(r),(t=>!t.message||!x.some((e=>t.message.includes(e))))(t)&&I(t))},N="FACEBOOK_PIXEL",E="Facebook Pixel",T=[{destKey:"external_id",sourceKeys:["userId","context.traits.userId","context.traits.id","anonymousId"]},{destKey:"em",sourceKeys:"context.traits.email"},{destKey:"ph",sourceKeys:"context.traits.phone"},{destKey:"ge",sourceKeys:"context.traits.gender"},{destKey:"db",sourceKeys:"context.traits.birthday"},{destKey:"ln",sourceKeys:["context.traits.lastname","context.traits.lastName","context.traits.last_name"]},{destKey:"fn",sourceKeys:["context.traits.firstname","context.traits.firstName","context.traits.first_name"]},{destKey:"ct",sourceKeys:["context.traits.address.city","context.traits.city"]},{destKey:"st",sourceKeys:["context.traits.address.state","context.traits.state"]},{destKey:"zp",sourceKeys:["context.traits.address.zip","context.traits.zip"]},{destKey:"country",sourceKeys:["context.traits.address.country","context.traits.country"]}],C=["email","lastName","firstName","phone","external_id","city","birthday","gender","street","zip","country"],B={LOG:{value:0,method:console.log},INFO:{value:1,method:console.info},DEBUG:{value:2,method:console.debug},WARN:{value:3,method:console.warn},ERROR:{value:4,method:console.error}};class q{constructor(t,e){this.level=+e||B.ERROR.value,this.scope=t||""}setLogLevel(t){if(t&&"string"==typeof t){const e=t.toUpperCase();this.level=B[e]?B[e].value:this.level}}setScope(t){this.scope=t||this.scope}log(...t){this.logBase(t,B.LOG.value)}info(...t){this.logBase(t,B.INFO.value)}debug(...t){this.logBase(t,B.DEBUG.value)}warn(...t){this.logBase(t,B.WARN.value)}error(...t){this.logBase(t,B.ERROR.value)}logBase(t,e){if(this.level<=e){Object.values(B).find((t=>t.value===e)).method(...this.getLogData(t))}}getLogData(t){if(Array.isArray(t)&&t.length>0){let e="%c RS SDK";this.scope&&(e=`${e} - ${this.scope}`);e=`${e} %c ${t[0].trim()}`;const n=[];return n.push(e),n.push("font-weight: bold; background: black; color: white;"),n.push("font-weight: normal;"),n.push(...t.slice(1)),n}return t}}var D,K;var R=function(){if(K)return D;K=1;var t,e,n=Object.prototype,r=n.hasOwnProperty,o=n.toString;"function"==typeof Symbol&&(t=Symbol.prototype.valueOf),"function"==typeof BigInt&&(e=BigInt.prototype.valueOf);var i=function(t){return t!=t},a={boolean:1,number:1,string:1,undefined:1},s=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/,c=/^[A-Fa-f0-9]+$/,u={};return u.a=u.type=function(t,e){return typeof t===e},u.defined=function(t){return void 0!==t},u.empty=function(t){var e,n=o.call(t);if("[object Array]"===n||"[object Arguments]"===n||"[object String]"===n)return 0===t.length;if("[object Object]"===n){for(e in t)if(r.call(t,e))return!1;return!0}return!t},u.equal=function(t,e){if(t===e)return!0;var n,r=o.call(t);if(r!==o.call(e))return!1;if("[object Object]"===r){for(n in t)if(!u.equal(t[n],e[n])||!(n in e))return!1;for(n in e)if(!u.equal(t[n],e[n])||!(n in t))return!1;return!0}if("[object Array]"===r){if((n=t.length)!==e.length)return!1;for(;n--;)if(!u.equal(t[n],e[n]))return!1;return!0}return"[object Function]"===r?t.prototype===e.prototype:"[object Date]"===r&&t.getTime()===e.getTime()},u.hosted=function(t,e){var n=typeof e[t];return"object"===n?!!e[t]:!a[n]},u.instance=u.instanceof=function(t,e){return t instanceof e},u.nil=u.null=function(t){return null===t},u.undef=u.undefined=function(t){return void 0===t},u.args=u.arguments=function(t){var e="[object Arguments]"===o.call(t),n=!u.array(t)&&u.arraylike(t)&&u.object(t)&&u.fn(t.callee);return e||n},u.array=Array.isArray||function(t){return"[object Array]"===o.call(t)},u.args.empty=function(t){return u.args(t)&&0===t.length},u.array.empty=function(t){return u.array(t)&&0===t.length},u.arraylike=function(t){return!!t&&!u.bool(t)&&r.call(t,"length")&&isFinite(t.length)&&u.number(t.length)&&t.length>=0},u.bool=u.boolean=function(t){return"[object Boolean]"===o.call(t)},u.false=function(t){return u.bool(t)&&!1===Boolean(Number(t))},u.true=function(t){return u.bool(t)&&!0===Boolean(Number(t))},u.date=function(t){return"[object Date]"===o.call(t)},u.date.valid=function(t){return u.date(t)&&!isNaN(Number(t))},u.element=function(t){return void 0!==t&&"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&1===t.nodeType},u.error=function(t){return"[object Error]"===o.call(t)},u.fn=u.function=function(t){if("undefined"!=typeof window&&t===window.alert)return!0;var e=o.call(t);return"[object Function]"===e||"[object GeneratorFunction]"===e||"[object AsyncFunction]"===e},u.number=function(t){return"[object Number]"===o.call(t)},u.infinite=function(t){return t===1/0||t===-1/0},u.decimal=function(t){return u.number(t)&&!i(t)&&!u.infinite(t)&&t%1!=0},u.divisibleBy=function(t,e){var n=u.infinite(t),r=u.infinite(e),o=u.number(t)&&!i(t)&&u.number(e)&&!i(e)&&0!==e;return n||r||o&&t%e==0},u.integer=u.int=function(t){return u.number(t)&&!i(t)&&t%1==0},u.maximum=function(t,e){if(i(t))throw new TypeError("NaN is not a valid value");if(!u.arraylike(e))throw new TypeError("second argument must be array-like");for(var n=e.length;--n>=0;)if(t<e[n])return!1;return!0},u.minimum=function(t,e){if(i(t))throw new TypeError("NaN is not a valid value");if(!u.arraylike(e))throw new TypeError("second argument must be array-like");for(var n=e.length;--n>=0;)if(t>e[n])return!1;return!0},u.nan=function(t){return!u.number(t)||t!=t},u.even=function(t){return u.infinite(t)||u.number(t)&&t==t&&t%2==0},u.odd=function(t){return u.infinite(t)||u.number(t)&&t==t&&t%2!=0},u.ge=function(t,e){if(i(t)||i(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t>=e},u.gt=function(t,e){if(i(t)||i(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t>e},u.le=function(t,e){if(i(t)||i(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t<=e},u.lt=function(t,e){if(i(t)||i(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t<e},u.within=function(t,e,n){if(i(t)||i(e)||i(n))throw new TypeError("NaN is not a valid value");if(!u.number(t)||!u.number(e)||!u.number(n))throw new TypeError("all arguments must be numbers");return u.infinite(t)||u.infinite(e)||u.infinite(n)||t>=e&&t<=n},u.object=function(t){return"[object Object]"===o.call(t)},u.primitive=function(t){return!t||!("object"==typeof t||u.object(t)||u.fn(t)||u.array(t))},u.hash=function(t){return u.object(t)&&t.constructor===Object&&!t.nodeType&&!t.setInterval},u.regexp=function(t){return"[object RegExp]"===o.call(t)},u.string=function(t){return"[object String]"===o.call(t)},u.base64=function(t){return u.string(t)&&(!t.length||s.test(t))},u.hex=function(t){return u.string(t)&&(!t.length||c.test(t))},u.symbol=function(e){return"function"==typeof Symbol&&"[object Symbol]"===o.call(e)&&"symbol"==typeof t.call(e)},u.bigint=function(t){return"function"==typeof BigInt&&"[object BigInt]"===o.call(t)&&"bigint"==typeof e.call(t)},D=u}();const F=u(R);var U,L,z,M;const H=u(function(){if(M)return z;M=1;const t=L?U:(L=1,U=function(t){return null!=t&&"object"==typeof t&&!1===Array.isArray(t)});function e(t,e,n){return"function"==typeof n.join?n.join(t):t[0]+e+t[1]}function n(t,e,n){return"function"!=typeof n.isValid||n.isValid(t,e)}function r(e){return t(e)||Array.isArray(e)||"function"==typeof e}return z=function(o,i,a){if(t(a)||(a={default:a}),!r(o))return void 0!==a.default?a.default:o;"number"==typeof i&&(i=String(i));const s=Array.isArray(i),c="string"==typeof i,u=a.separator||".",l=a.joinChar||("string"==typeof u?u:".");if(!c&&!s)return o;if(c&&i in o)return n(i,o,a)?o[i]:a.default;let f=s?i:function(t,e,n){if("function"==typeof n.split)return n.split(t);return t.split(e)}(i,u,a),d=f.length,p=0;do{let t=f[p];for("number"==typeof t&&(t=String(t));t&&"\\"===t.slice(-1);)t=e([t.slice(0,-1),f[++p]||""],l,a);if(t in o){if(!n(t,o,a))return a.default;o=o[t]}else{let r=!1,i=p+1;for(;i<d;)if(t=e([t,f[i++]],l,a),r=t in o){if(!n(t,o,a))return a.default;o=o[t],p=i-1;break}if(!r)return a.default}}while(++p<d&&r(o));return p===d?o:a.default}}()),V=t=>!(t=>void 0===t)(t),$=new q(E);function G(t){return H(t,"traits.event_id")||H(t,"context.traits.event_id")||H(t,"properties.event_id")||t.messageId}const J=t=>t&&(t[E]||t[N]),W=t=>{let e=t;if(Array.isArray(e)&&(e=e.map(String).join(",")),e&&"string"!=typeof e&&"object"!=typeof e&&(e=String(e)),!e||"string"==typeof e||Array.isArray(e)||"object"!=typeof e)return e;$.error("'properties.category' must be either be a string or an array")},Z=(t,e)=>{const n={};return Object.keys(t).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])})),Object.keys(e).forEach((t=>{Object.prototype.hasOwnProperty.call(e,t)&&!Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=e[t])})),n},X=t=>{const e=parseFloat(t),n=Number.isNaN(e)?0:parseFloat(e.toFixed(2));return Number.isNaN(n)&&$.error("Revenue could not be converted to a number"),n},Q=(t,e,n)=>{const r=J(t.message.integrations),o=null==r?void 0:r.contentType;if(o)return o;const{category:i}=t.message.properties;if(i){const t=null==n?void 0:n.find((t=>t.from===i));if(null!=t&&t.to)return t.to}return e},Y=(t,e,n,r)=>{const o=t?t.filter((t=>t)).map((({product_id:t,sku:o,id:i,quantity:a,price:s,delivery_category:c})=>{const u=t||o||i;return V(u)?{id:u,quantity:a||e||1,item_price:s||n,delivery_category:c||r}:null})).filter((t=>null!==t)):[],i=o.map((t=>t.id));return{contents:o,contentIds:i}},tt=(t,e,n)=>{const r=[],o=[];return t&&(o.push(t),r.push({id:t,quantity:e,item_price:n})),{contents:r,contentIds:o}},et=t=>t||"",nt=t=>t||"USD",rt=t=>(null==t?void 0:t.properties)||{},ot=(t,e,n)=>t||e||n,it=(t,e)=>t||e||"",at=(t,e)=>t||X(e),st=t=>"Product Viewed"===t?"ViewContent":"AddToCart",ct=(t,e,n)=>t?e:X(n),ut=(t,e,n)=>!t[null==n?void 0:n.toLowerCase()]&&!e[null==n?void 0:n.toLowerCase()],lt=t=>{V(t)||$.error("'properties.revenue' could not be converted to a number")};function ft(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function dt(t){return function e(n){return 0===arguments.length||ft(n)?e:t.apply(this,arguments)}}function pt(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return ft(n)?e:dt((function(e){return t(n,e)}));default:return ft(n)&&ft(r)?e:ft(n)?dt((function(e){return t(e,r)})):ft(r)?dt((function(e){return t(n,e)})):t(n,r)}}}const yt=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)};function gt(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function ht(t,e,n){for(var r=0,o=n.length;r<o;){if(t(e,n[r]))return!0;r+=1}return!1}function bt(t,e){return Object.prototype.hasOwnProperty.call(e,t)}const vt="function"==typeof Object.is?Object.is:function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e};var mt=Object.prototype.toString,wt=function(){return"[object Arguments]"===mt.call(arguments)?function(t){return"[object Arguments]"===mt.call(t)}:function(t){return bt("callee",t)}}(),jt=!{toString:null}.propertyIsEnumerable("toString"),St=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Ot=function(){return arguments.propertyIsEnumerable("length")}(),At=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},xt="function"!=typeof Object.keys||Ot?dt((function(t){if(Object(t)!==t)return[];var e,n,r=[],o=Ot&&wt(t);for(e in t)!bt(e,t)||o&&"length"===e||(r[r.length]=e);if(jt)for(n=St.length-1;n>=0;)bt(e=St[n],t)&&!At(r,e)&&(r[r.length]=e),n-=1;return r})):dt((function(t){return Object(t)!==t?[]:Object.keys(t)})),It=dt((function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)}));function kt(t,e,n,r){var o=gt(t);function i(t,e){return _t(t,e,n.slice(),r.slice())}return!ht((function(t,e){return!ht(i,e,t)}),gt(e),o)}function _t(t,e,n,r){if(vt(t,e))return!0;var o,i,a=It(t);if(a!==It(e))return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof e["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e)&&"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof e.equals)return"function"==typeof t.equals&&t.equals(e)&&"function"==typeof e.equals&&e.equals(t);switch(a){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===(o=t.constructor,null==(i=String(o).match(/^function (\w*)/))?"":i[1]))return t===e;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof e||!vt(t.valueOf(),e.valueOf()))return!1;break;case"Date":if(!vt(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(t.source!==e.source||t.global!==e.global||t.ignoreCase!==e.ignoreCase||t.multiline!==e.multiline||t.sticky!==e.sticky||t.unicode!==e.unicode)return!1}for(var s=n.length-1;s>=0;){if(n[s]===t)return r[s]===e;s-=1}switch(a){case"Map":return t.size===e.size&&kt(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size===e.size&&kt(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var c=xt(t);if(c.length!==xt(e).length)return!1;var u=n.concat([t]),l=r.concat([e]);for(s=c.length-1;s>=0;){var f=c[s];if(!bt(f,e)||!_t(e[f],t[f],u,l))return!1;s-=1}return!0}var Pt=pt((function(t,e){return _t(t,e,[],[])}));var Nt=dt((function(t){return null!=t&&"function"==typeof t["fantasy-land/empty"]?t["fantasy-land/empty"]():null!=t&&null!=t.constructor&&"function"==typeof t.constructor["fantasy-land/empty"]?t.constructor["fantasy-land/empty"]():null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():yt(t)?[]:function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)?"":function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)?{}:wt(t)?function(){return arguments}():function(t){var e=Object.prototype.toString.call(t);return"[object Uint8ClampedArray]"===e||"[object Int8Array]"===e||"[object Uint8Array]"===e||"[object Int16Array]"===e||"[object Uint16Array]"===e||"[object Int32Array]"===e||"[object Uint32Array]"===e||"[object Float32Array]"===e||"[object Float64Array]"===e||"[object BigInt64Array]"===e||"[object BigUint64Array]"===e}(t)?t.constructor.from(""):void 0})),Et=dt((function(t){return null!=t&&Pt(t,Nt(t))}));const Tt=(t,e="from",n="to",r=!0)=>{const o={};return Array.isArray(t)&&t.forEach((t=>{var i;("object"==typeof(i=t[e])||"string"==typeof i?!Et(i):Et(i))&&(o[r?t[e].toLowerCase():t[e]]=t[n])})),o};for(var Ct=256;Ct--;)(Ct+256).toString(16).substring(1);for(var Bt=0;Bt<256;Bt++)(Bt+256).toString(16).substring(1);const qt=t=>V(t)&&(t=>null!==t)(t),Dt=({message:t,operationObject:e})=>{const{operation:n,args:r}=e,o=r.map((e=>{const{sourceKeys:n,defaultVal:r}=e,o=H(t,n);return o||!1===o||0===o?o:r}));if(!o.every((t=>qt(t))))return null;let i=null;switch(n){case"multiplication":i=1;for(const t of o){if("number"!=typeof t)return null;i*=t}return i.toFixed(2);case"addition":i=0;for(const t of o){if("number"!=typeof t)return null;i+=t}return i.toFixed(2);default:return null}},Kt=(t,e)=>{let n=t;const r={jsonStringify:()=>{n=JSON.stringify(t)},jsonStringifyOnObject:()=>{"string"!=typeof t&&(n=JSON.stringify(t))},toString:()=>{n=String(t)},toNumber:()=>{n=Number(t)},toFloat:()=>{n=parseFloat(t)},toInt:()=>{n=parseInt(t,10)},toLower:()=>{n=t.toString().toLowerCase()},trim:()=>{"string"==typeof t&&(n=t.trim())},IsBoolean:()=>{n=!0,"boolean"!=typeof t&&(O.debug("Boolean value missing, so dropping it"),n=!1)}};if(e in r){(0,r[e])()}return n},Rt=(t,e)=>{const n={};return Array.isArray(e)&&e.length>0&&e.forEach((e=>{const{sourceKeys:r,destKey:o,metadata:i}=e,a=((t,e)=>{if(!e)return t;const{type:n,defaultValue:r}=e;if(!qt(t))return r||t;let o=t;return n&&(Array.isArray(n)?n.forEach((t=>{o=Kt(o,t)})):o=Kt(o,n)),o})(((t,e)=>{if(Array.isArray(e)&&e.length>0){for(const n of e){let e;if(e="object"==typeof n?Dt({message:t,operationObject:n}):H(t,n),e||!1===e||0===e)return e}return null}return"object"==typeof e?Dt({message:t,operationObject:e}):H(t,e)})(t,r),i);(a||0===a||!1===a)&&o&&(n[o]=a)})),n},Ft=new q(E);return t.FacebookPixel=class{constructor(t,e,n){e.logLevel&&Ft.setLogLevel(e.logLevel),this.autoConfig=void 0===t.autoConfig||t.autoConfig,this.blacklistPiiProperties=t.blacklistPiiProperties,this.categoryToContent=t.categoryToContent||[],this.pixelId=t.pixelId,this.eventsToEvents=t.eventsToEvents,this.valueFieldIdentifier=t.valueFieldIdentifier,this.advancedMapping=t.advancedMapping,this.traitKeyToExternalId=t.traitKeyToExternalId,this.legacyConversionPixelId=t.legacyConversionPixelId||[],this.userIdAsPixelId=t.userIdAsPixelId||[],this.whitelistPiiProperties=t.whitelistPiiProperties,this.useUpdatedMapping=t.useUpdatedMapping,this.name=N,this.analytics=e,({shouldApplyDeviceModeTransformation:this.shouldApplyDeviceModeTransformation,propagateEventsUntransformedOnError:this.propagateEventsUntransformedOnError,destinationId:this.destinationId}=null!=n?n:{})}init(){if(window._fbq=function(){window.fbq.callMethod?window.fbq.callMethod.apply(window.fbq,arguments):window.fbq.queue.push(arguments)},window.fbq=window.fbq||window._fbq,window.fbq.push=window.fbq,window.fbq.loaded=!0,window.fbq.disablePushState=!0,window.fbq.allowDuplicatePageViews=!0,window.fbq.version="2.0",window.fbq.queue=[],window.fbq("set","autoConfig",this.autoConfig,this.pixelId),this.advancedMapping){if(this.useUpdatedMapping){const t={context:{traits:r({},this.analytics.getUserTraits())},userId:this.analytics.getUserId(),anonymousId:this.analytics.getAnonymousId()},e=Rt(t,T);C.forEach((e=>{var n;null===(n=t.context)||void 0===n||delete n.traits[e]})),this.userPayload=r(r({},e),t.context.traits),this.userPayload.external_id&&(this.userPayload.external_id=j(this.userPayload.external_id).toString())}else this.userPayload=r({},this.analytics.getUserTraits());window.fbq("init",this.pixelId,this.userPayload)}else window.fbq("init",this.pixelId);((t,e,n={})=>{try{if(document.getElementById(t))return;const r=document.createElement("script");r.src=e,r.async=void 0===n.async||n.async,r.type="text/javascript",r.id=t,!0!==n.skipDatasetAttributes&&(r.setAttribute("data-loader",A),void 0!==n.isNonNativeSDK&&r.setAttribute("data-isNonNativeSDK",n.isNonNativeSDK));const o=document.getElementsByTagName("head");if(o.length>0)o[0].insertBefore(r,o[0].firstChild);else{const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(r,t)}}catch(t){P(t)}})("fbpixel-integration","https://connect.facebook.net/en_US/fbevents.js")}isLoaded(){var t;return!(null===(t=window.fbq)||void 0===t||!t.callMethod)}isReady(){return this.isLoaded()}page(t){const{properties:e}=t.message;window.fbq("track","PageView",e,{eventID:G(t.message)})}track(t){const{event:e}=t.message,n=rt(t.message),{id:r,sku:o,name:i,price:a,query:s,revenue:c,products:u,quantity:l,contentName:f,product_id:d,product_name:p,delivery_category:y,content_type:g}=n;let{value:h,category:b,currency:v}=n;const m=X(c);lt(m),v=nt(v);const w=((t,e,n,r)=>{const o=["checkinDate","checkoutDate","departingArrivalDate","departingDepartureDate","returningArrivalDate","returningDepartureDate","travelEnd","travelStart"],i=["email","firstName","lastName","gender","city","country","phone","state","zip","birthday"],a=e||[],s=(n||[]).reduce(((t,e)=>(t[e.blacklistPiiProperties]=e.blacklistPiiHash,t)),{}),c=a.map((t=>t.whitelistPiiProperties)),{properties:u}=t.message;return Object.entries(u).reduce(((t,[e,n])=>{const a=i.includes(e)||Object.prototype.hasOwnProperty.call(s,e),u=c.includes(e),l=o.includes(e)&&F.date(n);return l&&([t[e]]=n.toISOString().split("T")),s[e]&&"string"==typeof n?t[e]=r?n.toString():j(n).toString():a&&!u||l?$.info(`PII Property '${n}' is neither hashed nor whitelisted and will be ignored`):t[e]=n,t}),{})})(t,this.whitelistPiiProperties,this.blacklistPiiProperties,(t=>{const e=J(t.integrations);return null==e?void 0:e.hashed})(t.message)),S=this.eventsToEvents,O=this.legacyConversionPixelId,A=Tt(S),x=Tt(O),I="properties.value"===this.valueFieldIdentifier,k=ot(d,o,r);if(h=at(m,h),b&&!W(b))return;b=W(b);const _=G(t.message);if("Product List Viewed"===e){const{contentIds:r,contentType:o,contents:i}=(t=>{const{products:e,category:n,quantity:r,price:o}=t,{contents:i,contentIds:a}=Y(e,r,o);let s;return a.length>0?s="product":n&&(a.push(n),i.push({id:n,quantity:1}),s="product_group"),{contentIds:a,contentType:s,contents:i}})(n),a={content_ids:r,content_type:g||Q(t,o,this.categoryToContent),contents:i,content_category:et(b),content_name:f,value:h,currency:v};this.makeTrackSignalCall(this.pixelId,"ViewContent",Z(a,w),_),this.makeTrackSignalCalls(this.pixelId,e,x,_,{currency:v,value:m})}else if("Product Viewed"===e||"Product Added"===e){const{contents:n,contentIds:r}=tt(k,l,a),o={content_ids:r,content_type:g||Q(t,"product",this.categoryToContent),content_name:it(p,i),content_category:et(b),currency:v,value:ct(I,h,a),contents:n};this.makeTrackSignalCall(this.pixelId,st(e),Z(o,w),_),this.makeTrackSignalCalls(this.pixelId,e,x,_,{currency:v,value:o.value})}else if("Order Completed"===e){const{contents:n,contentIds:r}=Y(u,l,a,y),o={content_ids:r,content_type:g||Q(t,"product",this.categoryToContent),currency:v,value:m,contents:n,num_items:r.length,content_name:f};this.makeTrackSignalCall(this.pixelId,"Purchase",Z(o,w),_),this.makeTrackSignalCalls(this.pixelId,e,x,_,{currency:v,value:m})}else if("Products Searched"===e){const{contents:t,contentIds:n}=tt(k,l,a),r={content_ids:n,content_category:et(b),currency:v,value:h,contents:t,search_string:s};this.makeTrackSignalCall(this.pixelId,"Search",Z(r,w),_),this.makeTrackSignalCalls(this.pixelId,e,x,_,{currency:v,value:h})}else if("Checkout Started"===e){var P;let n=b;const{contents:r,contentIds:o}=Y(u,l,a);Array.isArray(u)&&!n&&null!==(P=u[0])&&void 0!==P&&P.category&&(n=u[0].category);const i={content_ids:o,content_type:g||Q(t,"product",this.categoryToContent),content_category:n,currency:v,value:m,contents:r,num_items:o.length};this.makeTrackSignalCall(this.pixelId,"InitiateCheckout",Z(i,w),_),this.makeTrackSignalCalls(this.pixelId,e,x,_,{currency:v,value:m})}else ut(A,x,e)?(w.value=m,window.fbq("trackSingleCustom",this.pixelId,e,w,{eventID:_})):(Ft.info("Not standard event & no custom mapping available"),w.value=m,w.currency=v,this.makeTrackSignalCalls(this.pixelId,e,A,_,w),this.makeTrackSignalCalls(this.pixelId,e,x,_,{currency:v,value:m}))}makeTrackSignalCalls(t,e,n,r,o){p(((n,i)=>{i===e.toLowerCase()&&window.fbq("trackSingle",t,n,o,{eventID:r})}),n)}makeTrackSignalCall(t,e,n,r){window.fbq("trackSingle",t,e,n,{eventID:r})}},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t}({});
//# sourceMappingURL=FacebookPixel.min.js.map
